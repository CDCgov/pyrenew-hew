% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fetch_reporting_data_gh.R
\name{fetch_reporting_data_gh_csv}
\alias{fetch_reporting_data_gh_csv}
\title{Fetch reporting data from GitHub commit history}
\usage{
fetch_reporting_data_gh_csv(
  reference_dates,
  report_dates,
  locations = NULL,
  repo = "CDCgov/covid19-forecast-hub",
  file_path = "target-data/covid-hospital-admissions.csv",
  github_token = NULL
)
}
\arguments{
\item{reference_dates}{Date vector of reference dates to include in the triangle.
These are the dates for which hospital admissions are being reported.}

\item{report_dates}{Date vector of report dates (Saturdays). These represent when
the forecaster sees the data (the Saturday following a Wednesday data update).
For each date, the function will find the nearest GitHub commit on or before that date.
Must be Saturdays.}

\item{locations}{Character vector of geographic locations (e.g., state abbreviations
like "CA", "NY", or "US" for national). If NULL (default), all locations are returned.}

\item{repo}{Character, GitHub repository in format "owner/repo". Default is
"CDCgov/covid19-forecast-hub".}

\item{file_path}{Character, path to the target data file within the repository.
Default is "target-data/covid-hospital-admissions.csv".}

\item{github_token}{Optional character, GitHub personal access token for API
authentication. If NULL, uses GITHUB_PAT or GITHUB_TOKEN environment variable.
Anonymous requests are limited to 60/hour.}
}
\value{
A data.frame with columns:
\describe{
\item{reference_date}{Date, the date of hospital admissions}
\item{report_date}{Date, the date this version of the data was available}
\item{location}{Character, geographic location code}
\item{count}{Numeric, hospital admissions count}
}
}
\description{
This function fetches historical versions of the COVID-19 hospital admissions
target data from the covid19-forecast-hub GitHub repository. Each version
represents a "snapshot" of the data as it existed at a particular report date,
allowing you to track how reference date values were revised over time.
}
\details{
The function uses the GitHub API to:
\enumerate{
\item List commits that modified the target data file
\item For each search_date, find the most recent commit on or before that date
\item Fetch the file content at that commit SHA
\item Parse the CSV and extract rows matching locations and reference_dates
\item Combine all versions into a reporting triangle format
}

\strong{Date conventions:}
\itemize{
\item report_dates: Saturdays (when forecaster sees data after Wednesday update)
\item The function searches for GitHub commits on or before each report_date
}

The resulting data.frame can be passed to
\code{\link[baselinenowcast]{as_reporting_triangle}} for nowcasting.
}
\examples{
\dontrun{
# Fetch data using report_dates (Saturdays)
data <- fetch_reporting_data_github(
  locations = c("CA", "NY"),
  reference_dates = seq(as.Date("2024-11-22"), as.Date("2024-12-13"), by = "week"),
  report_dates = seq(as.Date("2024-11-22"), as.Date("2024-12-13"), by = "week")
)

# Create reporting triangle
library(baselinenowcast)
triangle <- as_reporting_triangle(data, delays_unit = "weeks")
}
}
